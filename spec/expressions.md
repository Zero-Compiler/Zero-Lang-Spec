# 表达式

本文档定义 Zero 语言中的各种表达式。

---

## 概述

表达式是产生值的代码结构。Zero 中的表达式包括：

- 字面量表达式
- 变量表达式
- 二元表达式
- 一元表达式
- 函数调用表达式
- 括号表达式
- 赋值表达式
- 范围表达式

---

## 字面量表达式

直接使用字面量值。

### 整数字面量

```zero
42
-100
0
```

**类型**: Integer

---

### 浮点数字面量

```zero
3.14
-2.5
0.0
```

**类型**: Float

---

### 字符串字面量

```zero
"Hello"
"Zero Language"
""
```

**类型**: String

---

### 布尔字面量

```zero
true
false
```

**类型**: Boolean

---

## 变量表达式

使用标识符引用变量的值。

**语法**: `identifier`

**要求**: 变量必须在使用前声明

**示例**:

```zero
let x = 10;
let y = x;       // x 是变量表达式
let z = x + y;   // x 和 y 都是变量表达式
```

---

## 二元表达式

使用二元运算符组合两个表达式。

**语法**: `expr1 op expr2`

### 算术二元表达式

```zero
a + b    // 加法
a - b    // 减法
a * b    // 乘法
a / b    // 除法
a % b    // 取模
```

### 比较二元表达式

```zero
a == b   // 等于
a != b   // 不等于
a < b    // 小于
a <= b   // 小于等于
a > b    // 大于
a >= b   // 大于等于
```

### 逻辑二元表达式

```zero
a && b   // 逻辑与
a || b   // 逻辑或
```

### 范围表达式

```zero
a..b     // 范围
```

---

## 一元表达式

使用一元运算符作用于一个表达式。

**语法**: `op expr`

### 逻辑非

```zero
!true     // false
!false    // true
!(x > 5)  // 取反比较结果
```

### 一元负号

```zero
-42       // -42
-x        // x 的相反数
-(a + b)  // 表达式结果的相反数
```

---

## 括号表达式

使用括号改变求值顺序或提高可读性。

**语法**: `(expr)`

**示例**:

```zero
(1 + 2) * 3      // 9，不是 7
((a + b) * c)    // 明确优先级
(x)              // 等价于 x
```

---

## 函数调用表达式

调用函数并传递参数。

**语法**: `function_name(arg1, arg2, ...)`

**示例**:

```zero
print("Hello");
add(10, 20);
factorial(5);
```

### 无参数调用

```zero
get_value();
```

### 链式调用

```zero
f()(x)  // 先调用 f()，然后调用返回值
```

---

## 赋值表达式

将值赋给变量。

**语法**: `identifier = expr`

**要求**:

- 变量必须用 `var` 声明
- 表达式类型必须与变量类型匹配

**返回值**: 赋值表达式返回被赋的值

**示例**:

```zero
var x = 10;
x = 20;          // 赋值表达式
x = x + 5;       // 可以使用自身
```

### 链式赋值

```zero
var a = 1;
var b = 2;
a = b = 3;       // a 和 b 都是 3
```

---

## 范围表达式

创建用于 for 循环的范围。

**语法**: `start..end`

**要求**: start 和 end 必须是 Integer 类型

**语义**: 半开区间 [start, end)

**示例**:

```zero
for i in 0..10 {
    // i 从 0 到 9
}
```

---

## 表达式优先级

详见[运算符文档](operators.md#运算符优先级和结合性)。

---

## 求值顺序

### 从左到右

二元运算符的操作数从左到右求值：

```zero
f() + g() + h()  // 顺序: f(), g(), h()
```

### 函数参数

函数参数从左到右求值：

```zero
func(a(), b(), c())  // 顺序: a(), b(), c()
```

### 短路求值

逻辑运算符使用短路求值：

```zero
false && expensive()  // expensive() 不会被调用
true || expensive()   // expensive() 不会被调用
```

---

## 表达式类型

每个表达式都有确定的类型：

```zero
42              // Integer
3.14            // Float
"hello"         // String
true            // Boolean
x               // 取决于 x 的类型
10 + 20         // Integer
3.14 * 2.0      // Float
x == y          // Boolean
add(1, 2)       // 取决于 add 的返回类型
```

---

## 表达式组合

表达式可以嵌套和组合：

```zero
(a + b) * (c + d)
f(g(x), h(y))
x > 0 && x < 100
a + b * c / d
```

---

## 表达式作为语句

表达式后跟分号可以作为语句：

```zero
print("Hello");     // 函数调用表达式作为语句
x + y;              // 有效但无意义（值被丢弃）
42;                 // 有效但无意义
```

---

## 总结

Zero 的表达式系统：

- **简洁**: 清晰的语法
- **类型安全**: 编译时类型检查
- **可组合**: 表达式可以任意嵌套
- **可预测**: 明确的求值顺序和优先级
